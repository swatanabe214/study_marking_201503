SELECT
	e.uid AS EVENT_ID,
	EVENT_NAME,
	MIN(s.uid) AS SCHEDULE_ID,
	DATE_FORMAT(MIN(due_date), '%Y/%m/%d') AS DUE_DATE
FROM
	events e
LEFT JOIN
	schedules s
ON
	e.uid = s.event_id
WHERE
	due_date >= (SELECT MAX(sysdate) FROM dummy_sysdate)
OR
	due_date IS NULL
GROUP BY
	e.uid,
	event_name
ORDER BY
	s.event_id IS NULL,
	MIN(due_date),
	e.uid;