SELECT
	EVENT_ID,
	EVENT_NAME,
	SCHEDULE_ID,
	date_format(MIN(due_date), '%Y/%m/%d') AS DUE_DATE
FROM
	(
		SELECT
			e.uid AS EVENT_ID,
			e.EVENT_NAME,
			s.uid AS SCHEDULE_ID,
			s.due_date
		FROM
			events e
			LEFT JOIN
				schedules s
			ON  e.uid = s.event_id
		WHERE
			s.uid IS NULL
		OR  (
				SELECT
					MAX(sysdate)
				FROM
					dummy_sysdate
			) <= s.due_date
	) es
GROUP BY
	event_id,
	event_name
ORDER BY
	es.due_date IS NULL,
	es.due_date,
	event_id;